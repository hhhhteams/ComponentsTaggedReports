<script src="https://hhhhteams.sharepoint.com/sites/HHHHTeams/Style%20Library/js/angular/ComponentsTaggedReports/TestComponentsTaggedReports.js?updated=05082020"></script>
<script src="https://hhhhteams.sharepoint.com/sites/HHHHTeams/Style%20Library/js/angular/Templates/HCTemplateControllers.js?updated=23-03-2019"></script>
<script src="https://hhhhteams.sharepoint.com/sites/HHHHTeams/Style%20Library/js/angular/Services/alasql.min.js"></script>
<div ng-controller="ComponentsTaggedReportsController" ng-cloak class="report">
    <ng-form name="ItemForm" novalidate role="form">

        <div class="form-group">
            <div class="col-sm-3 padL-0">
                <label class="full_width" ng-bind-html="GetColumnDetails('StartDate') | trustedHTML"></label>
                <select ng-required="true" id="startmonth" ng-change="getdetailsSelectMonth()" name="month" ng-model="StartMonth" class="form-control select col-sm-6">
                    <option ng-repeat="month in months" value="{{month.value}}" ng-selected="{{month.Selected}}">{{month.text}}</option>
                </select>

                <select ng-required="true" id="startyear" name="year" ng-model="StartYear" class="form-control select col-sm-5 ml5">
                    <option ng-repeat="year in years" value="{{year.value}}" ng-selected="{{year.Selected}}">{{year.value}}</option>
                </select>
            </div>
            <div class="col-sm-3 padL-0">
                <label ng-required="true" class="full_width" ng-bind-html="GetColumnDetails('EndDate') | trustedHTML"></label>
                <select id="endmonth" name="month" ng-change="getdetailsSelectEndMonth()" ng-model="EndMonth" class="form-control  select col-sm-6">
                    <option ng-repeat="month in months" value="{{month.value}}">{{month.text}}</option>
                </select>
                <select ng-required="true" id="endyear" name="year" ng-model="EndYear" class="form-control  select col-sm-5 ml5">
                    <option ng-repeat="year in years" value="{{year.value}}">{{year.value}}</option>
                </select>
            </div>
            <div class="col-sm-2 padL-0 PadR0 general-option" style="margin-top: 16px;">
                <div class="col-sm-12  padL-0 PadR0">
                    <input type="checkbox" ng-model="CompletionDate" class="form-group" ng-click="DateCompareClink('CompletedDate')" /> Completion Date
                </div>

                <div class="col-sm-12  padL-0 PadR0">
                    <input type="checkbox" ng-model="CreatedDate" class="form-group" ng-click="CreatedDateCompareClink('Created')" /> Created Date
                </div>
                <div class="col-sm-12  padL-0 PadR0">
                    <input type="checkbox" ng-model="TimeEntry" class="form-group" ng-click="TimeEntryCompareClick('TimeEntry')" /> Time Entry
                </div>
            </div>
            <div class="col-sm-2 padL-0 PadR0 general-option" style="width:270px;">
                <fieldset class="fieldsett">
                    <legend class="activity" ng-bind-html="GetColumnDetails('Sites') | trustedHTML"></legend>
                    <div class="col-sm-6 mb-10" ng-repeat="item in SiteDetails">
                        <input type="checkbox" style="margin: 0px 0px 0px;" ng-click="editSite(item)" ng-model="item.Selected" name="site">
                        {{item.Title}}

                    </div>
                </fieldset>
            </div>
            <div class="col-sm-2 padL-0 PadR0 " style="width:158px;">
                <label class="full_width"></label>
                <button type="button" ng-disabled="ItemForm.$error.required || isButtonEnabled" class="btn btn-primary pull-right" ng-click="generateReports()">Generate Reports</button>
            </div>
            <div class="clearfix"></div>
        </div>

    </ng-form>


    <div id="showSearchBox" class="col-sm-12 padL-0 PadR0">
        <div class="col-sm-11 padL-0 form-group PadR0" style="width:1238px;">
            <input id="searchinput" type="search" ng-model="globalSearch" placeholder="Search all..." class="searchhbox_height t form-control searchbox_height">
            <span class="searchclear" ng-show="globalSearch.length>0"  ng-click="clearControl('searchinput')">X</span>
            <div class="clearfix"></div>
        </div>
        <div class="col-sm-1" style="width:61px;">
            <img class="pull-right hreflink" ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/icon_excel.png" ng-click="exportToExcelPopup()">
        </div>
        <div class="col-sm-12 padL-0 PadR0">
            <div id="table-wrapper-institution" class="section-event pt-0">
                <ul id="contact" class="table table-hover SAP-Project">
                    <li class="for-lis">
                        <div style="width: 2%">
                            <div style="width: 80%">
                                <a class="hreflink" ng-show="expand_collapse" ng-click="filterExpanded(ReportComponentsItems)" title="Tap to expand the childs">

                                    <img style="width: 10px;" ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/right-list-icon.png">
                                </a>
                                <a class="hreflink" ng-show="!expand_collapse" ng-click="filterCollapsed(ReportComponentsItems)" title="Tap to Shrink the childs">
                                    <img style="width: 10px;" ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/list-icon.png">
                                </a>
                            </div>
                        </div>
                        <div style="width: 2%">
                            <div style="width: 80%"></div>
                        </div>
                        <div style="width:8%;" class="">
                            <div style="width:70%;" class="">
                                <input type="text" id="searchTaskId" placeholder="TaskId" class="searchbox_height width-90 ng-valid ng-dirty ng-touched ng-empty" ng-model="searchTaskId" />
                                <span class="searchclear" ng-show="searchTaskId.length>0" ng-click="clearControl('searchTaskId')">X</span>
                                <span class="{{orderBy=='Shareweb_x0020_ID'&&!reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortBy('Shareweb_x0020_ID', false)"></span>
                                <span class="{{orderBy=='Shareweb_x0020_ID'&&reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortBy('Shareweb_x0020_ID', true)"></span>
                            </div>
                        </div>
                        <div style="width: 35%;" class="">
                            <div style="width: 98%">
                                <input id="searchTitle" type="search" placeholder="Title" class="width-90 searchbox_height" ng-model="searchTitle" />
                                <span class="searchclear" ng-show="searchTitle.length>0" ng-click="clearControl('searchTitle')">X</span>
                                <span class="{{orderBy=='Title'&&!reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortBy('Title', false)"></span>
                                <span class="{{orderBy=='Title'&&reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortBy('Title', true)"></span>

                            </div>
                        </div>

                        <div style="width:13%;" class="">
                            <div style="width:80%;" class="">
                                <input type="text" id="searchComponent" placeholder="Component" class="searchbox_height width-90 ng-valid ng-dirty ng-touched ng-empty" ng-model="searchComponent" />
                                <span class="searchclear" ng-show="searchComponent.length>0" ng-click="clearControl('searchComponent')">X</span>
                                <span class="{{orderBy=='ComponentName'&&!reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortBy('ComponentName', false)"></span>
                                <span class="{{orderBy=='ComponentName'&&reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortBy('ComponentName', true)"></span>
                            </div>
                        </div>
                        <!--<div style="width:9%;" class="">
                            <div style="width:76%;" class="">
                                <input type="text" id="searchSynonyms" placeholder="Synonyms" class="searchbox_height width-90 ng-valid ng-dirty ng-touched ng-empty" ng-model="searchSynonyms" />
                                <span class="searchclear" ng-click="clearControl('searchSynonyms')">X</span>
                                <span class="{{orderBy=='Deliverable_x002d_Synonyms'&&!reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortBy('Deliverable_x002d_Synonyms', false)"></span>
                                <span class="{{orderBy=='Deliverable_x002d_Synonyms'&&reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortBy('Deliverable_x002d_Synonyms', true)"></span>
                            </div>
                        </div>-->

                        <div style="width:6%;" class="">
                            <div style="width:70%;" class="">
                                <input type="text" id="searchPercentComplete" placeholder="%" class="searchbox_height width-90 ng-valid ng-dirty ng-touched ng-empty" ng-model="searchPercentComplete" />
                                <span class="searchclear" ng-show="searchPercentComplete.length>0" ng-click="clearControl('searchPercentComplete')">X</span>
                                <span class="{{orderBy=='PercentComplete'&&!reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortBy('PercentComplete', false)"></span>
                                <span class="{{orderBy=='PercentComplete'&&reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortBy('PercentComplete', true)"></span>
                            </div>
                        </div>
                        <div style="width: 10%;" class="">
                            <div style="width: 80%">
                                <input id="searchDueDate" type="search" placeholder="Completion date" class="width-90 searchbox_height" ng-model="searchDueDate" />
                                <span class="searchclear" ng-show="searchDueDate.length>0" ng-click="clearControl('searchDueDate')">X</span>
                                <span class="{{orderBy=='NewCompletedDate'&&!reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortBy('NewCompletedDate', false)"></span>
                                <span class="{{orderBy=='NewCompletedDate'&&reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortBy('NewCompletedDate', true)"></span>

                            </div>
                        </div>
                        <div style="width: 10%;" class="">
                            <div style="width: 80%">
                                <input id="searchDueDate" type="search" placeholder="Created" class="width-90 searchbox_height" ng-model="searchCreatedDate" />
                                <span class="searchclear" ng-show="searchCreatedDate.length>0" ng-click="clearControl('searchCreatedDate')">X</span>
                                <span class="{{orderBy=='NewCreated'&&!reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortBy('NewCreated', false)"></span>
                                <span class="{{orderBy=='NewCreated'&&reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortBy('NewCreated', true)"></span>

                            </div>
                        </div>
                        <div style="width: 6%;" class="">
                            <div style="width: 80%">
                                <input id="searchEffort" type="search" placeholder="Effort" class="width-90 searchbox_height" ng-model="searchEffort" />
                                <span class="searchclear" ng-show="searchEffort.length>0" ng-click="clearControl('searchEffort')">X</span>
                                <span class="{{orderBy=='Effort'&&!reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortBy('Effort', false)"></span>
                                <span class="{{orderBy=='Effort'&&reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortBy('Effort', true)"></span>
                            </div>
                        </div>
                        <div style="width: 6%;" class="">
                            <div style="width: 80%">
                                <input id="searchShare" type="search" placeholder="Share" class="width-90 searchbox_height" ng-model="searchShare" />
                                <span class="searchclear" ng-show="searchShare.length>0" ng-click="clearControl('searchShare')">X</span>
                                <span class="{{orderBy=='TaskShare'&&!reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortBy('TaskShare', false)"></span>
                                <span class="{{orderBy=='TaskShare'&&reverse?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortBy('TaskShare', true)"></span>
                            </div>
                        </div>
                        <div style="width:7%" class="padLR"><div style="width: 80%"></div></div>
                    </li>
                    <div class="container-new">
                        <li class="for-lis {{report.Portfoliotype=='Service'?'taskprofilepagegreen':''}} tdrows" ng-repeat-start="report in FilteredComponents = (ReportComponentsItems | treeStrucureFiltering: globalSearch  | orderBy:orderBy:reverse | treeStrucureFiltering:{Title:searchTitle,FilterCompletedDate:searchDueDate,FiltercreatedDate:searchCreatedDate,Effort:searchEffort,Status:searchStatus,PercentComplete:searchPercentComplete,ComponentName:searchComponent,Shareweb_x0020_ID:searchTaskId,Deliverable_x002d_Synonyms:searchSynonyms,TaskShare:searchShare})" style="width:100%">
                            <div style="width: 2%;">
                                <span ng-show="!report.expanded && report.childs.length>0" class="hreflink" ng-click="toggleGroup(report);">
                                    <img ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/right-list-icon.png">
                                </span>
                                <span ng-show="report.expanded && report.childs.length>0" class="hreflink" ng-click="toggleGroup(report);">
                                    <img ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/list-icon.png">
                                </span>
                            </div>
                            <div style="width:2%;">
                                <img ng-if="report.siteType =='Gruene'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Foundation/logo-gruene.png">
                                <img ng-if="report.siteType =='Gender'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_gender.png">
                                <img ng-if="report.siteType =='DE'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_de.png" />
                                <img ng-if="report.siteType =='DRR'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_drr.png">
                                <img ng-if="report.siteType =='Education'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_education.png">
                                <img ng-if="report.siteType =='EI'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_ei.png">
                                <img ng-if="report.siteType =='EPS'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_eps.png">
                                <img ng-if="report.siteType =='Health'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_health.png">
                                <img ng-if="report.siteType =='QA'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_qa.png">
                                <img ng-if="report.siteType =='Shareweb'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_shareweb.png">
                                <img ng-if="report.siteType =='HHHH'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Foundation/icon_hhhh.png">
                                <img ng-if="report.siteType =='Small Projects'" class="icon-sites-img ml-8"
                                     ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/small_project.png">
                            </div>
                            <div style="width:8%;" class="padLR">
                                {{report.Shareweb_x0020_ID}}
                            </div>
                            <div style="width: 35%;" class="padLR padL-0">
                                <span style="width: 30%;" ng-if="report.childs!=undefined">
                                    <span class="hreflink">
                                        <a ng-if="report.Item_x0020_Type !=undefined  && report.Id !=undefined" ng-href="https://hhhhteams.sharepoint.com/sites/HHHHTeams/sp/SitePages/Portfolio-Profile.aspx?taskId={{report.Id}}" target="_blank" class="hreflink Report-title">
                                            <span ng-if="report.editable != true">{{report.Title}}</span>
                                        </a>
                                        <a ng-if="report.Item_x0020_Type ==undefined && report.Id !=undefined" ng-href="https://hhhhteams.sharepoint.com/sites/HHHHTeams/sp/SitePages/Task-Profile.aspx?taskId={{report.Id}}&Site={{report.siteType}}" target="_blank" class="hreflink Report-title">
                                            <span ng-if="report.editable != true">{{report.Title}}</span>
                                        </a>
                                        <a ng-if="report.Id ==undefined" class="hreflink Report-title">
                                            <span ng-if="report.editable != true">{{report.Title}}</span>
                                        </a>

                                        <span ng-hide="filteredItems.length=='0'">({{filteredItems.length}})</span>
                                    </span>
                                </span>
                                <span style="display:inline-block;" ng-if="report.childs==undefined">
                                    <a ng-if="report.Item_x0020_Type !=undefined" ng-href="https://hhhhteams.sharepoint.com/sites/HHHHTeams/sp/SitePages/Portfolio-Profile.aspx?taskId={{report.Id}}" target="_blank" class="hreflink Report-title">
                                        <span ng-if="report.editable != true">{{report.Title}}</span>
                                    </a>
                                    <a ng-if="report.Item_x0020_Type ==undefined" ng-href="https://hhhhteams.sharepoint.com/sites/HHHHTeams/sp/SitePages/Task-Profile.aspx?taskId={{report.Id}}&Site={{report.siteType}}" target="_blank" class="hreflink Report-title">
                                        <span ng-if="report.editable != true">{{report.Title}}</span>
                                    </a>

                                    <div class="project-tool">
                                        <img ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/infoIcon.png" />

                                        <span class="tooltipte" ng-if="report.FeedBackDescriptionsBody[0].FeedBackDescriptions.length>0">
                                            <span class="tooltiptext">

                                                <div class="tooltip_Desc" ng-repeat="item in report.FeedBackDescriptionsBody[0].FeedBackDescriptions">

                                                    <span ng-bind-html="item.Title | trustedHTML"></span>

                                                </div>

                                            </span>
                                        </span>
                                    </div>
                                    <div class="col-sm-11 padL-0 PadR0"><input ng-if="report.editable == true" class="form-control" ng-model="report['Title']" type="text" /></div>
                                    <div class="col-sm-1 no-padding"><span ng-if="report.TaskItems.length>0" title="Show Description"> <img ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/infoIcon.png" ng-click="showDescription(report)"></span></div>
                                </span>

                            </div>
                            <div style="width:13%;" class="padLR">
                                <a ng-href="https://hhhhteams.sharepoint.com/sites/HHHHTeams/sp/SitePages/Portfolio-Profile.aspx?taskId={{report.ComponentIDs}}" target="_blank" class="hreflink">
                                    {{report.ComponentName}}
                                </a>
                            </div>
                            <!--<div style="width:9%;" class="padLR pl-10">
                                {{report.Deliverable_x002d_Synonyms}}
                            </div>-->
                            <div style="width:6%;" class="padLR pl-10">
                                {{report.PercentComplete}}
                            </div>
                            <div style="width: 10%;" class="padLR pl-10">{{report.FilterCompletedDate}}</div>
                            <div style="width: 10%;" class="padLR pl-10">{{report.FiltercreatedDate}}</div>
                            <div style="width: 6%;" class="padLR pl-10">{{report.Effort}}</div>
                            <div style="width: 6%;" class="padLR pl-10">
                                <span ng-show="report.TaskShare!=0 && report.TaskShare!=undefined">{{report.TaskShare}}%</span>
                                <span ng-show="report.TaskShare==0">100%</span>
                            </div>

                            <div style="width: 7%;" class="padLR">
                                <span ng-if="report.Name != 'Designs' && report.Name != 'Bugs'">
                                    <a ng-if="report.childs==undefined" class="hreflink ng-scope no-padding" title="Details" data-toggle="modal" ng-click="getTimeJson(report)"><img class="button-icon" ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/View%20Details1-WF.png" src="{{baseUrl}}/SiteCollectionImages/ICONS/24/View%20Details1-WF.png"> </a>
                                    <a ng-if="report.childs==undefined && report.editable != true" class="hreflink" title="Edit Inline" ng-click="EditContents(report)">
                                        <img ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/32/icon_inline.png">
                                    </a>
                                    <a ng-if="report.childs==undefined" class="hreflink ng-scope no-padding" title="Edit" data-toggle="modal" ng-click="EditTask(report)"><img class="img-focus" ng-src="/_layouts/images/edititem.gif" src="/_layouts/images/edititem.gif"> </a>

                                    <a ng-if="report.editable == true" class="hreflink" title="Save" ng-click="SaveItem(report)">
                                        <img class="wid22" ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/32/save.png">
                                    </a>

                                    <a ng-if="report.editable == true" class="hreflink" title="Cancel" ng-click="CancelItem(report)">
                                        <img class="wid22" ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/32/cancel.png">

                                    </a>
                                </span>
                            </div>
                        </li>
                        <div ng-show="report.expanded && report.childs.length>0" ng-repeat-end>
                            <div class="phase-td">
                                <ul class="table table-hover phase" width="100%">
                                    <li class="{{item.Portfoliotype=='Service'?'taskprofilepagegreen':''}}  tdrows for-lis for-c0l form-goup" ng-repeat="item in filteredItems=(report.childs |  filter: globalSearch |orderBy:orderBy:reverse )">
                                        <div style="width:2%;">
                                        </div>
                                        <div style="width:2%;">
                                            <img ng-if="item.siteType =='Gruene'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Foundation/logo-gruene.png">
                                            <img ng-if="item.siteType =='Gender'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_gender.png">
                                            <img ng-if="item.siteType =='DE'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_de.png" />
                                            <img ng-if="item.siteType =='DRR'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_drr.png">
                                            <img ng-if="item.siteType =='Education'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_education.png">
                                            <img ng-if="item.siteType =='EI'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_ei.png">
                                            <img ng-if="item.siteType =='EPS'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_eps.png">
                                            <img ng-if="item.siteType =='Health'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_health.png">
                                            <img ng-if="item.siteType =='QA'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_qa.png">
                                            <img ng-if="item.siteType =='Shareweb'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/site_shareweb.png">
                                            <img ng-if="item.siteType =='HHHH'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Foundation/icon_hhhh.png">
                                            <img ng-if="item.siteType =='Small Projects'" class="icon-sites-img ml-8"
                                                 ng-src="{{pageContextInfo.siteAbsoluteUrl}}/SiteCollectionImages/ICONS/Shareweb/small_project.png">
                                        </div>
                                        <div style="width:8%;" class="padLR">
                                            {{item.Shareweb_x0020_ID}}
                                        </div>
                                        <div style="width:35%;" class="padLR padL-0">
                                            <span style="display: inline-block;">

                                                <a ng-if="item.Item_x0020_Type !=undefined" href="https://hhhhteams.sharepoint.com/sites/HHHHTeams/sp/SitePages/Portfolio-Profile.aspx?taskId={{item.Id}}" target="_blank" class="hreflink Report-title">

                                                    <span ng-if="report.editable != true">{{item.Title}}</span>
                                                </a>
                                                <a ng-if="item.Item_x0020_Type ==undefined" href="https://hhhhteams.sharepoint.com/sites/HHHHTeams/sp/SitePages/Task-Profile.aspx?taskId={{item.Id}}&Site={{item.siteType}}" target="_blank" class="hreflink Report-title">
                                                    <span ng-if="report.editable != true">{{item.Title}}</span>
                                                </a>

                                                <div class="project-tool" ng-if="item.Body!=undefined && item.editable != true" title="Show Description">
                                                    <img ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/infoIcon.png" />

                                                    <span class="tooltipte" ng-if="item.FeedBackDescriptionsBody[0].FeedBackDescriptions.length>0">
                                                        <span class="tooltiptext">
                                                            <span class="icon"></span>

                                                            <div class="tooltip_Desc" ng-repeat="item1 in item.FeedBackDescriptionsBody[0].FeedBackDescriptions">

                                                                <span ng-bind-html="item1.Title | trustedHTML"></span>

                                                            </div>

                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-sm-11 padL-0 PadR0"> <input ng-if="item.editable == true" class="form-control" ng-model="item['Title']" type="text" /></div>
                                                <div class="col-sm-1 no-padding"> <span ng-if="item.Body!=undefined && item.editable == true" title="Show Description"> <img ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/infoIcon.png" ng-click="showDescription(item)"></span></div>
                                            </span>
                                        </div>
                                        <div style="width:13%;" class="padLR">
                                            <a ng-href="https://hhhhteams.sharepoint.com/sites/HHHHTeams/sp/SitePages/Portfolio-Profile.aspx?taskId={{item.ComponentIDs}}" target="_blank" class="hreflink">
                                                {{item.ComponentName}}
                                            </a>
                                        </div>
                                        <!--<div style="width:9%;" class="padLR pl-10">
                                            {{item.Deliverable_x002d_Synonyms}}
                                        </div>-->
                                        <div style="width:6%;" class="padLR pl-10">
                                            {{item.PercentComplete}}
                                        </div>
                                        <div style="width:10%;" class="padLR pl-10" ng-bind="item.FilterCompletedDate"></div>
                                        <div style="width:10%;" class="padLR pl-10" ng-bind="item.FiltercreatedDate"></div>
                                        <div style="width:6%;" class="padLR pl-10" ng-bind="item.Effort"></div>
                                        <div ng-show="item.TaskShare!=0" style="width:6%;" class="padLR pl-10">
                                            {{item.TaskShare}}%
                                        </div>
                                        <div ng-show="item.TaskShare==0" style="width:6%;" class="padLR pl-10">
                                            100%
                                        </div>
                                        <div class="icontype display_hide padLR" style="width:7%;">
                                            <span>
                                                <a class="hreflink no-padding" title="Details" data-toggle="modal" ng-click="getTimeJson(item)"><img class="button-icon" ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/24/View%20Details1-WF.png" src="{{baseUrl}}/SiteCollectionImages/ICONS/24/View%20Details1-WF.png"> </a>
                                                <a ng-if="item.editable != true" class="hreflink" title="Edit Inline" ng-click="EditContents(item)">
                                                    <img ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/32/icon_inline.png">
                                                </a>
                                                <a class="hreflink no-padding" title="Edit" data-toggle="modal" ng-click="EditTask(item)"><img class="img-focus" ng-src="/_layouts/images/edititem.gif" src="/_layouts/images/edititem.gif"> </a>

                                                <a ng-if="item.editable == true" class="hreflink" title="Save" ng-click="SaveItem(item)">
                                                    <img class="wid22" ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/32/save.png">
                                                </a>

                                                <a ng-if="item.editable == true" class="hreflink" title="Cancel" ng-click="CancelItem(item)">
                                                    <img class="wid22" ng-src="{{baseUrl}}/SiteCollectionImages/ICONS/32/cancel.png">

                                                </a>
                                            </span>
                                        </div>

                                    </li>
                                </ul>
                            </div>

                        </div>
                    </div>
                </ul>
            </div>
        </div>

    </div>

    <div id="exportToexcelpopupdata" class="modal" role="dialog">
        <div class="modal-dialog">
            <div class="panel panel-default">
                <ng-form name="createContactForm" novalidate role="form">
                    <div class="panel-title">
                        <button type="button" class="close minwid-10 mt-5" ng-click="cancelexportToExcelPopup()">&times;</button>
                        <h3>
                            <img class="wid22" ng-if="Item.Attachments" ng-src="{{baseUrl}}/admin/Lists/Contacts/Attachments/{{Item.Id}}/ContactPicture.jpg" />
                            Export To Excel

                            <span class="pull-right">
                                <page-settings-info webpartid="'exporttoexcelPopup'"></page-settings-info>
                            </span>
                        </h3>
                    </div>
                    <div class="modal-body">
                        <div class="col-sm-12 tab-content bdrbox">
                            <div ng-repeat="item in exportcolumns">
                                <div class="col-sm-6">
                                    <div class="col-sm-12 checkbox">
                                        <label class="ng-binding">
                                            <input id="chkCompareContact_{{item.Id}}" type="checkbox" ng-model="item.isChecked" name="chkContact" ng-click=checkexportcolumn(item) />
                                            {{item.DisplayName}}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer pr-5">
                        <span class="pull-right">
                            <button type="button" class="btn btn-primary" ng-click="exportToExcel()">Create</button>
                            <button type="button" class="btn btn-default" ng-click="cancelexportToExcelPopup()">Cancel</button>
                        </span>
                    </div>
                </ng-form>
            </div>
        </div>
    </div>


    <div id="showDescriptionPopup" class="modal fade in disnone" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
        <div class="modal-dialog">
            <div class="panel panel-default">
                <div class="panel-title">
                    <button type="button" class="close minwid-10" data-dismiss="modal" ng-click="closeDescriptionPopup()">&times;</button>
                    <h3 class="modal-title">
                        {{ItemDetails.Title}}
                    </h3>

                </div>
                <div class="modal-body tab-content imageinfo_border bdrtop">
                    <div class="col-sm-12 panel-padding no-padding">
                        <div class="col-sm-12 panel-padding" ng-if="ItemDetails.FeedBackDescriptionsBody==0"> <span ng-bind-html="ItemDetails.Body | trustedHTML"></span></div>
                        <div ng-if="ItemDetails.FeedBackDescriptionsBody[0].FeedBackDescriptions.length>0" ng-repeat="item in ItemDetails.FeedBackDescriptionsBody[0].FeedBackDescriptions">
                            <div class="col-sm-12 Description_item">

                                <span ng-bind-html="item.Title | trustedHTML"></span>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">

                    <button type="button" class="btn btn-primary" ng-click="closeDescriptionPopup()" title="Close">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="ShowTimeEnteryPopup" class="modal fade in "  role="dialog" >
        <div class="modal-dialog" style="width: 1000px;">
            <div class="panel panel-default">
             
                    <div class="panel-title">
                        <button type="button" class="close minwid-10 mt-5" ng-click="cancelTimePopup()">&times;</button>
                        <h3>
                            All Time Entry
                            <span class="pull-right">
                                <page-settings-info webpartid="'ShowAllTimeEntryPopup'"></page-settings-info>
                            </span>
                        </h3>
                    </div>
                    <div class="modal-body">
                        <div class="col-sm-12  tab-content bdrbox">
                            <div class="section-event pt-0 mt-10 mb-10">                           
                                <ul class="table table-hover" width="100%">
                                    <li class="for-lis">
                                        <div style="width:20%">
                                            <div style="width: 90%">
                                                <input id="TimeTaskTitle" type="search" placeholder="Title" class="width-90 searchbox_height" ng-model="TimeTaskTitle">
                                                <span class="searchclear" ng-show="TimeTaskTitle.length>0" ng-click="clearControl('TimeTaskTitle')">X</span>
                                                <span class="{{orderByPopup=='TimeTitle'&&!reversePopup?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortByPopup('TimeTitle', false)"></span>
                                                <span class="{{orderByPopup=='TimeTitle'&&reversePopup?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortByPopup('TimeTitle', true)"></span>
                                            </div>
                                        </div>
                                        <div style="width:12%">
                                            <div style="width: 65%">
                                                <input id="TimeTaskDate" type="search" placeholder="Date" class="width-90 searchbox_height" ng-model="TimeTaskDate">
                                                <span class="searchclear" ng-show="TimeTaskDate.length>0" ng-click="clearControl('TimeTaskDate')">X</span>
                                                <span class="{{orderByPopup=='TaskDate'&&!reversePopup?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortByPopup('TaskDate', false)"></span>
                                                <span class="{{orderByPopup=='TaskDate'&&reversePopup?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortByPopup('TaskDate', true)"></span>
                                            </div>

                                        </div>
                                        <div style="width:8%">
                                            <div style="width: 65%">
                                                <input id="searchTaskTime" type="search" placeholder="Time" class="width-90 searchbox_height" ng-model="searchTaskTime">
                                                <span class="searchclear" ng-show="searchTaskTime.length>0" ng-click="clearControl('searchTaskTime')">X</span>
                                                <span class="{{orderByPopup=='TaskTime'&&!reversePopup?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortByPopup('TaskTime', false)"></span>
                                                <span class="{{orderByPopup=='TaskTime'&&reversePopup?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortByPopup('TaskTime', true)"></span>
                                            </div>

                                        </div>
                                        <div style="width:48%">
                                            <div style="width: 90%">
                                                <input id="TimeDescription" type="search" placeholder="Description" class="width-90 searchbox_height" ng-model="TimeDescription">
                                                <span class="searchclear" ng-show="TimeDescription.length>0" ng-click="clearControl('TimeDescription')">X</span>
                                                <span class="{{orderByPopup=='Description'&&!reversePopup?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortByPopup('Description', false)"></span>
                                                <span class="{{orderByPopup=='Description'&&reversePopup?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortByPopup('Description', true)"></span>
                                            </div>
                                        </div>
                                        <div style="width:15%">
                                            <div style="width: 90%">
                                                <input id="TimeAuthorName" type="search" placeholder="Name" class="width-90 searchbox_height" ng-model="TimeAuthorName">
                                                <span class="searchclear" ng-show="TimeAuthorName.length>0" ng-click="clearControl('TimeAuthorName')">X</span>
                                                <span class="{{orderByPopup=='AuthorName'&&!reversePopup?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-up direction-arrow arrow_up" ng-click="sortByPopup('AuthorName', false)"></span>
                                                <span class="{{orderByPopup=='AuthorName'&&reversePopup?'glyphicon_active':'glyphicon'}}  glyphicon-chevron-down direction-arrow arrow_down" ng-click="sortByPopup('AuthorName', true)"></span>
                                            </div>
                                        </div>
                                    </li>
                                    <div class="container-new" ng-show="ShowTimeEnteryItem.length >0">
                                        <li class="for-lis {{item.Expanded?'project_active tdrows':'tdrows'}}" ng-repeat="item in FilterJSON =(ShowTimeEnteryItem | orderBy:orderByPopup:reversePopup |filter:{AuthorName:TimeAuthorName,TimeTitle:TimeTaskTitle,TaskDate:TimeTaskDate,TaskTime:searchTaskTime,Description:TimeDescription})">
                                            <div style="width:20%;" class="padLR padL-0">{{item.TimeTitle}}</div>
                                            <div style="width:12%;" class="padLR padL-0">
                                                {{item.TaskDate}}
                                            </div>
                                            <div style="width:8%;" class="padLR padL-0">
                                                {{item.TaskTime}}
                                            </div>
                                            <div style="width:48%;" class="padLR padL-0">
                                                {{item.Description}}
                                            </div>
                                            <div style="width:15%;" class="padLR padL-0">{{item.AuthorName}}</div>
                                        </li>
                                    </div>
                                    <div id="contact" class="col-sm-12 padL-0 PadR0 mt-10 mb-10" ng-show="ShowTimeEnteryItem ==undefined || ShowTimeEnteryItem.length ==0">
                                        <div class="current_commnet">No JSON available</div>
                                    </div>
                                </ul>                            
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer pr-5">
                        <span class="pull-right">
                            <!--<button type="button" class="btn btn-primary" ng-click="exportToExcel()">Create</button>-->
                            <button type="button" class="btn btn-default" ng-click="cancelTimePopup()">Cancel</button>
                        </span>
                    </div>                            
             </div>
        </div>
    </div>


 </div>
